<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Banking Risk Management Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
            background: #f8f9fb;
            color: #1e293b;
        }

        /* Layout */
        .app-container {
            display: flex;
            height: 100vh;
            overflow: hidden;
        }

        /* Sidebar */
        .sidebar {
            width: 260px;
            background: white;
            border-right: 1px solid #e2e8f0;
            display: flex;
            flex-direction: column;
            transition: width 0.3s ease;
        }

        .sidebar.collapsed {
            width: 70px;
        }

        .sidebar-header {
            padding: 24px 20px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 700;
            font-size: 18px;
        }

        .logo-text {
            font-size: 18px;
            font-weight: 600;
            color: #1e40af;
        }

        .sidebar.collapsed .logo-text {
            display: none;
        }

        .nav-menu {
            flex: 1;
            padding: 20px 0;
        }

        .nav-item {
            padding: 12px 20px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 12px;
            color: #64748b;
            transition: all 0.2s;
            font-size: 14px;
            font-weight: 500;
        }

        .nav-item:hover {
            background: #f1f5f9;
            color: #1e40af;
        }

        .nav-item.active {
            background: #eff6ff;
            color: #1e40af;
            border-right: 3px solid #3b82f6;
        }

        .nav-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
        }

        .sidebar.collapsed .nav-text {
            display: none;
        }

        /* Main Content */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* Top Bar */
        .top-bar {
            background: white;
            border-bottom: 1px solid #e2e8f0;
            padding: 16px 32px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 24px;
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 10px 16px 10px 40px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            transition: border 0.2s;
        }

        .search-bar input:focus {
            border-color: #3b82f6;
        }

        .search-icon {
            position: absolute;
            left: 12px;
            top: 50%;
            transform: translateY(-50%);
            color: #94a3b8;
        }

        .top-bar-actions {
            display: flex;
            align-items: center;
            gap: 16px;
        }

        .notification-btn,
        .profile-btn {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background 0.2s;
            position: relative;
        }

        .notification-btn {
            background: #f1f5f9;
            color: #64748b;
        }

        .notification-btn:hover {
            background: #e2e8f0;
        }

        .notification-badge {
            position: absolute;
            top: 8px;
            right: 8px;
            width: 8px;
            height: 8px;
            background: #ef4444;
            border-radius: 50%;
            border: 2px solid white;
        }

        .profile-btn {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
            font-weight: 600;
            font-size: 14px;
        }

        /* Content Area */
        .content-area {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
        }

        /* Page Header */
        .page-header {
            margin-bottom: 32px;
        }

        .page-title {
            font-size: 28px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 8px;
        }

        .page-subtitle {
            font-size: 14px;
            color: #64748b;
        }

        /* KPI Cards */
        .kpi-grid {
            display: flex;
            gap: 20px;
            margin-bottom: 32px;
            overflow-x: auto;
            padding-bottom: 10px;
        }

        .kpi-grid::-webkit-scrollbar {
            height: 6px;
        }

        .kpi-grid::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }

        .kpi-grid::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }

        .kpi-grid::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }

        .kpi-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            border: 1px solid #e2e8f0;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
            position: relative;
            overflow: hidden;
            min-width: 200px;
            width: 200px;
            height: 200px;
            flex-shrink: 0;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #1e40af 0%, #3b82f6 100%);
            transform: scaleX(0);
            transform-origin: left;
            transition: transform 0.3s ease;
        }

        .kpi-card:hover::before {
            transform: scaleX(1);
        }

        .kpi-card:hover {
            box-shadow: 0 12px 28px rgba(59, 130, 246, 0.2);
            transform: translateY(-6px);
            border-color: #3b82f6;
        }

        .kpi-card:active {
            transform: translateY(-4px) scale(0.98);
        }

        .kpi-header {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .kpi-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
            transition: transform 0.3s ease;
        }

        .kpi-card:hover .kpi-icon {
            transform: scale(1.1) rotate(5deg);
        }

        .kpi-label {
            font-size: 12px;
            color: #64748b;
            font-weight: 600;
            line-height: 1.3;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .kpi-value {
            font-size: 32px;
            font-weight: 800;
            color: #0f172a;
            line-height: 1;
            margin: 8px 0;
        }

        .kpi-trend {
            display: inline-flex;
            align-items: center;
            gap: 4px;
            font-size: 11px;
            font-weight: 700;
            padding: 4px 10px;
            border-radius: 6px;
            width: fit-content;
        }

        .trend-up {
            color: #059669;
            background: #d1fae5;
        }

        .trend-down {
            color: #dc2626;
            background: #fee2e2;
        }

        .kpi-subtitle {
            font-size: 11px;
            color: #94a3b8;
            margin-top: 4px;
            font-weight: 500;
        }

        @media (max-width: 1200px) {
            .kpi-card {
                min-width: 180px;
                width: 180px;
                height: 180px;
            }
        }

        @media (max-width: 768px) {
            .kpi-card {
                min-width: 160px;
                width: 160px;
                height: 160px;
            }

            .kpi-value {
                font-size: 28px;
            }
        }

        /* Modal Animations */
        @keyframes fadeIn {
            from {
                opacity: 0;
            }

            to {
                opacity: 1;
            }
        }

        @keyframes slideUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Chart Cards */
        .chart-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 24px;
            margin-bottom: 24px;
        }

        @media (max-width: 1024px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
        }

        .chart-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .chart-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
        }

        .chart-subtitle {
            font-size: 13px;
            color: #64748b;
            margin-top: 4px;
        }

        /* Tables */
        .table-card {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            overflow: hidden;
        }

        .table-header {
            padding: 20px 24px;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: #0f172a;
        }

        .table-actions {
            display: flex;
            gap: 12px;
        }

        .table-container {
            overflow-x: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        thead {
            background: #f8f9fb;
        }

        th {
            text-align: left;
            padding: 12px 24px;
            font-size: 13px;
            font-weight: 600;
            color: #475569;
            border-bottom: 1px solid #e2e8f0;
        }

        td {
            padding: 16px 24px;
            font-size: 14px;
            color: #1e293b;
            border-bottom: 1px solid #f1f5f9;
        }

        tr:hover {
            background: #f8f9fb;
        }

        /* Badges */
        .badge {
            display: inline-flex;
            align-items: center;
            padding: 4px 12px;
            border-radius: 6px;
            font-size: 12px;
            font-weight: 600;
        }

        .badge-low {
            background: #d1fae5;
            color: #065f46;
        }

        .badge-medium {
            background: #fed7aa;
            color: #92400e;
        }

        .badge-high {
            background: #fecaca;
            color: #991b1b;
        }

        .badge-critical {
            background: #fca5a5;
            color: #7f1d1d;
        }

        /* Buttons */
        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #1e40af 0%, #3b82f6 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: white;
            color: #1e40af;
            border: 1px solid #e2e8f0;
        }

        .btn-secondary:hover {
            background: #f8f9fb;
        }

        /* Risk Score Gauge */
        .risk-gauge-container {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 40px;
        }

        .risk-gauge {
            position: relative;
            width: 200px;
            height: 200px;
        }

        .gauge-score {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .gauge-value {
            font-size: 48px;
            font-weight: 700;
            color: #0f172a;
        }

        .gauge-label {
            font-size: 14px;
            color: #64748b;
            margin-top: 4px;
        }

        /* Timeline */
        .timeline {
            padding: 24px;
        }

        .timeline-item {
            display: flex;
            gap: 16px;
            margin-bottom: 24px;
            position: relative;
        }

        .timeline-item:not(:last-child)::before {
            content: '';
            position: absolute;
            left: 15px;
            top: 32px;
            bottom: -24px;
            width: 2px;
            background: #e2e8f0;
        }

        .timeline-dot {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
            z-index: 1;
        }

        .timeline-content {
            flex: 1;
            padding-top: 4px;
        }

        .timeline-title {
            font-size: 14px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 4px;
        }

        .timeline-desc {
            font-size: 13px;
            color: #64748b;
        }

        .timeline-date {
            font-size: 12px;
            color: #94a3b8;
            margin-top: 4px;
        }

        /* Action Panel */
        .action-panel {
            background: white;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            padding: 24px;
        }

        .action-item {
            padding: 16px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-item:hover {
            border-color: #3b82f6;
            background: #f8f9fb;
        }

        .action-title {
            font-size: 14px;
            font-weight: 600;
            color: #0f172a;
            margin-bottom: 8px;
        }

        .action-meta {
            display: flex;
            gap: 16px;
            font-size: 12px;
            color: #64748b;
        }

        /* Filter Panel */
        .filter-panel {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
            margin-bottom: 24px;
        }

        .filter-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
        }

        .filter-group label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: #475569;
            margin-bottom: 8px;
        }

        .filter-group select {
            width: 100%;
            padding: 10px 12px;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            font-size: 14px;
            outline: none;
            cursor: pointer;
        }

        /* Metric Cards for Model Monitoring */
        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 32px;
        }

        .metric-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            border: 1px solid #e2e8f0;
        }

        .metric-header {
            display: flex;
            justify-content: space-between;
            align-items: start;
            margin-bottom: 16px;
        }

        .metric-icon {
            width: 40px;
            height: 40px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
        }

        .metric-value-large {
            font-size: 36px;
            font-weight: 700;
            color: #0f172a;
            margin-bottom: 4px;
        }

        .metric-label {
            font-size: 13px;
            color: #64748b;
        }

        /* Loading States */
        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .skeleton {
            background: linear-gradient(90deg, #f1f5f9 25%, #e2e8f0 50%, #f1f5f9 75%);
            background-size: 200% 100%;
            animation: pulse 1.5s ease-in-out infinite;
            border-radius: 4px;
        }

        /* Responsive */
        @media (max-width: 1024px) {
            .sidebar {
                width: 70px;
            }

            .sidebar .logo-text,
            .sidebar .nav-text {
                display: none;
            }

            .chart-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {
            .content-area {
                padding: 20px;
            }

            .kpi-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Page visibility */
        .page {
            display: none;
            animation: fadeIn 0.3s ease-in;
        }

        .page.active {
            display: block;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .progress-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.3s ease;
        }
    </style>
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <div class="logo">BR</div>
                <div class="logo-text">BankRisk Pro</div>
            </div>
            <div class="nav-menu">
                <div class="nav-item active" data-page="dashboard" onclick="showPage('dashboard')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6">
                        </path>
                    </svg>
                    <span class="nav-text">Dashboard Overview</span>
                </div>
                <div class="nav-item" data-page="portfolio" onclick="showPage('portfolio')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z">
                        </path>
                    </svg>
                    <span class="nav-text">Portfolio Risk</span>
                </div>
                <div class="nav-item" data-page="operations" onclick="showPage('operations')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2">
                        </path>
                    </svg>
                    <span class="nav-text">User Operation Tracker</span>
                </div>
                <div class="nav-item" data-page="customer" onclick="showPage('customer')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M10 21h7a2 2 0 002-2V9.414a1 1 0 00-.293-.707l-5.414-5.414A1 1 0 0012.586 3H7a2 2 0 00-2 2v11m0 5l4.879-4.879m0 0a3 3 0 104.243-4.242 3 3 0 00-4.243 4.242z">
                        </path>
                    </svg>
                    <span class="nav-text">Customer Profile Lookup</span>
                </div>
                <div class="nav-item" data-page="model" onclick="showPage('model')">
                    <svg class="nav-icon" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z">
                        </path>
                    </svg>
                    <span class="nav-text">Model Monitoring</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Top Bar -->
            <div class="top-bar">
                <div class="search-bar">
                    <svg class="search-icon" width="20" height="20" fill="none" stroke="currentColor"
                        viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                    </svg>
                    <input type="text" placeholder="Search customers, loans, reports...">
                </div>
                <div class="top-bar-actions">
                    <div class="notification-btn">
                        <div class="notification-badge"></div>
                        <svg width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9">
                            </path>
                        </svg>
                    </div>
                    <div class="profile-btn">AS</div>
                </div>
            </div>

            <!-- Content Area -->
            <div class="content-area">
                <!-- PAGE 1: EXECUTIVE DASHBOARD -->
                <div id="page-dashboard" class="page active">
                    <div class="page-header">
                        <h1 class="page-title">Executive Dashboard</h1>
                        <p class="page-subtitle">Real-time portfolio risk overview and key performance indicators</p>
                    </div>

                    <!-- Alert Notifications -->
                    <div style="margin-bottom: 32px;">
                        <!-- Critical Alerts -->
                        <div style="background: #fef2f2; border-left: 4px solid #ef4444; padding: 18px 24px; border-radius: 8px; margin-bottom: 14px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); cursor: pointer;"
                            onclick="showAlertDetails('critical')">
                            <div style="display: flex; align-items: start; gap: 14px;">
                                <div
                                    style="background: #ef4444; width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <svg width="20" height="20" fill="white" viewBox="0 0 16 16">
                                        <path
                                            d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                        <path
                                            d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z" />
                                    </svg>
                                </div>
                                <div style="flex: 1;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 6px;">
                                        <div>
                                            <div
                                                style="font-size: 15px; font-weight: 600; color: #991b1b; margin-bottom: 3px;">
                                                23 accounts flagged for immediate review</div>
                                            <div style="font-size: 13px; color: #7f1d1d; line-height: 1.5;">Risk scores
                                                increased significantly overnight - portfolio exposure ₹8.2M</div>
                                        </div>
                                        <div
                                            style="background: #ef4444; color: white; padding: 3px 10px; border-radius: 4px; font-size: 11px; font-weight: 600; white-space: nowrap;">
                                            URGENT</div>
                                    </div>
                                    <div style="font-size: 12px; color: #991b1b; margin-top: 6px;">
                                        Needs attention • Last updated 2 hours ago
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Warning Alert -->
                        <div style="background: #fffbeb; border-left: 4px solid #f59e0b; padding: 18px 24px; border-radius: 8px; margin-bottom: 14px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); cursor: pointer;"
                            onclick="showAlertDetails('warning')">
                            <div style="display: flex; align-items: start; gap: 14px;">
                                <div
                                    style="background: #f59e0b; width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <svg width="20" height="20" fill="white" viewBox="0 0 16 16">
                                        <path
                                            d="M8.982 1.566a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566zM8 5c.535 0 .954.462.9.995l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995A.905.905 0 0 1 8 5zm.002 6a1 1 0 1 1 0 2 1 1 0 0 1 0-2z" />
                                    </svg>
                                </div>
                                <div style="flex: 1;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 6px;">
                                        <div>
                                            <div
                                                style="font-size: 15px; font-weight: 600; color: #92400e; margin-bottom: 3px;">
                                                Model showing data drift in income patterns</div>
                                            <div style="font-size: 13px; color: #78350f; line-height: 1.5;">Consider
                                                retraining soon - PSI score reached 0.18 threshold</div>
                                        </div>
                                        <div
                                            style="background: #f59e0b; color: white; padding: 3px 10px; border-radius: 4px; font-size: 11px; font-weight: 600;">
                                            REVIEW</div>
                                    </div>
                                    <div style="font-size: 12px; color: #92400e; margin-top: 6px;">
                                        Model Monitoring • Detected yesterday
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Info Alert -->
                        <div style="background: #eff6ff; border-left: 4px solid #3b82f6; padding: 18px 24px; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.08); cursor: pointer;"
                            onclick="showAlertDetails('info')">
                            <div style="display: flex; align-items: start; gap: 14px;">
                                <div
                                    style="background: #3b82f6; width: 36px; height: 36px; border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                                    <svg width="20" height="20" fill="white" viewBox="0 0 16 16">
                                        <path
                                            d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm.93-9.412-1 4.705c-.07.34.029.533.304.533.194 0 .487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703 0-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381 2.29-.287zM8 5.5a1 1 0 1 1 0-2 1 1 0 0 1 0 2z" />
                                    </svg>
                                </div>
                                <div style="flex: 1;">
                                    <div
                                        style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 6px;">
                                        <div>
                                            <div
                                                style="font-size: 15px; font-weight: 600; color: #1e40af; margin-bottom: 3px;">
                                                Collections running 1.2% above target this month</div>
                                            <div style="font-size: 13px; color: #1e3a8a; line-height: 1.5;">Early
                                                intervention approach continues to show good results</div>
                                        </div>
                                    </div>
                                    <div style="font-size: 12px; color: #1e40af; margin-top: 6px;">
                                        Portfolio Update • As of today
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- KPI Cards -->
                    <div class="kpi-grid">
                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div class="kpi-icon" style="background: #dbeafe; color: #1e40af;">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />
                                        <path
                                            d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2H3z" />
                                    </svg>
                                </div>
                                <div class="kpi-label">Total Active<br>Loans</div>
                            </div>
                            <div>
                                <div class="kpi-value">24,582</div>
                                <div class="kpi-trend trend-up">↑ 3.2%</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div class="kpi-icon" style="background: #fee2e2; color: #dc2626;">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                        <path
                                            d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z" />
                                    </svg>
                                </div>
                                <div class="kpi-label">At-Risk<br>Customers</div>
                            </div>
                            <div>
                                <div class="kpi-value">1,847</div>
                                <div class="kpi-trend trend-down">↓ 5.8%</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div class="kpi-icon" style="background: #fef3c7; color: #92400e;">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                                        <path
                                            d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
                                    </svg>
                                </div>
                                <div class="kpi-label">30-Day<br>Delinquency</div>
                            </div>
                            <div>
                                <div class="kpi-value">4.2%</div>
                                <div class="kpi-trend trend-down">↓ 1.3%</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div class="kpi-icon" style="background: #fed7aa; color: #92400e;">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z" />
                                    </svg>
                                </div>
                                <div class="kpi-label">Portfolio<br>Loss</div>
                            </div>
                            <div>
                                <div class="kpi-value">₹12.4M</div>
                                <div class="kpi-trend trend-down">↓ 8.5%</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div class="kpi-icon" style="background: #d1fae5; color: #065f46;">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zm-3.97-3.03a.75.75 0 0 0-1.08.022L7.477 9.417 5.384 7.323a.75.75 0 0 0-1.06 1.06L6.97 11.03a.75.75 0 0 0 1.079-.02l3.992-4.99a.75.75 0 0 0-.01-1.05z" />
                                    </svg>
                                </div>
                                <div class="kpi-label">Intervention<br>Success</div>
                            </div>
                            <div>
                                <div class="kpi-value">76.3%</div>
                                <div class="kpi-trend trend-up">↑ 4.1%</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div class="kpi-icon" style="background: #e0e7ff; color: #3730a3;">
                                    <svg width="20" height="20" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5v12h-2V2h2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z" />
                                    </svg>
                                </div>
                                <div class="kpi-label">Average<br>Portfolio PD</div>
                            </div>
                            <div>
                                <div class="kpi-value">18.9%</div>
                                <div class="kpi-trend trend-up">↑ 6.2%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Charts Row 1 -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Risk Distribution</div>
                                    <div class="chart-subtitle">Portfolio segmentation by risk level</div>
                                </div>
                            </div>
                            <canvas id="riskDistChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Risk Trend Analysis</div>
                                    <div class="chart-subtitle">6-month delinquency rate tracking</div>
                                </div>
                            </div>
                            <canvas id="riskTrendChart"></canvas>
                        </div>
                    </div>

                    <!-- Charts Row 2 -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Risk by Loan Product Type</div>
                                    <div class="chart-subtitle">Distribution across product categories</div>
                                </div>
                            </div>
                            <canvas id="loanTypeChart"></canvas>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Regional Risk Analysis</div>
                                    <div class="chart-subtitle">Geographic risk concentration</div>
                                </div>
                            </div>
                            <canvas id="regionalChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- PAGE 2: PORTFOLIO RISK -->
                <div id="page-portfolio" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Portfolio Risk Analysis</h1>
                        <p class="page-subtitle">Comprehensive view of loan portfolio distribution and risk
                            concentration</p>
                    </div>

                    <!-- Portfolio Summary Cards -->
                    <div class="kpi-grid" style="grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));">
                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div style="flex: 1;">
                                    <div class="kpi-label">Total Portfolio Value</div>
                                </div>
                                <div class="kpi-icon" style="background: #dbeafe; color: #1e40af;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M1 3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1H1zm7 8a2 2 0 1 0 0-4 2 2 0 0 0 0 4z" />
                                        <path
                                            d="M0 5a1 1 0 0 1 1-1h14a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1H1a1 1 0 0 1-1-1V5zm3 0a2 2 0 0 1-2 2v4a2 2 0 0 1 2 2h10a2 2 0 0 1 2-2V7a2 2 0 0 1-2-2H3z" />
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <div class="kpi-value" id="port-total-value">₹845.2Cr</div>
                                <div class="kpi-trend trend-up">
                                    <span id="port-total-trend">↑ 12.4%</span>
                                </div>
                                <div class="kpi-subtitle" id="port-total-sub">YoY Growth</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div style="flex: 1;">
                                    <div class="kpi-label">Healthy Loans</div>
                                </div>
                                <div class="kpi-icon" style="background: #d1fae5; color: #065f46;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z" />
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <div class="kpi-value" id="port-healthy-value">22,735</div>
                                <div class="kpi-trend trend-up">
                                    <span id="port-healthy-trend">92.5%</span>
                                </div>
                                <div class="kpi-subtitle" id="port-healthy-sub">Of total loans</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div style="flex: 1;">
                                    <div class="kpi-label">Avg Loan Size</div>
                                </div>
                                <div class="kpi-icon" style="background: #e0e7ff; color: #3730a3;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M4 10.781c.148 1.667 1.513 2.85 3.591 3.003V15h1.043v-1.216c2.27-.179 3.678-1.438 3.678-3.3 0-1.59-.947-2.51-2.956-3.028l-.722-.187V3.467c1.122.11 1.879.714 2.07 1.616h1.47c-.166-1.6-1.54-2.748-3.54-2.875V1H7.591v1.233c-1.939.23-3.27 1.472-3.27 3.156 0 1.454.966 2.483 2.661 2.917l.61.162v4.031c-1.149-.17-1.94-.8-2.131-1.718H4zm3.391-3.836c-1.043-.263-1.6-.825-1.6-1.616 0-.944.704-1.641 1.8-1.828v3.495l-.2-.05zm1.591 1.872c1.287.323 1.852.859 1.852 1.769 0 1.097-.826 1.828-2.2 1.939V8.73l.348.086z" />
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <div class="kpi-value" id="port-avg-size-value">₹3.4L</div>
                                <div class="kpi-trend trend-up">
                                    <span id="port-avg-size-trend">↑ 2.8%</span>
                                </div>
                                <div class="kpi-subtitle" id="port-avg-size-sub">Per customer</div>
                            </div>
                        </div>

                        <div class="kpi-card">
                            <div class="kpi-header">
                                <div style="flex: 1;">
                                    <div class="kpi-label">NPL Ratio</div>
                                </div>
                                <div class="kpi-icon" style="background: #fef3c7; color: #92400e;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                        <path
                                            d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z" />
                                    </svg>
                                </div>
                            </div>
                            <div>
                                <div class="kpi-value" id="port-npl-value">2.8%</div>
                                <div class="kpi-trend trend-down">
                                    <span id="port-npl-trend">↓ 0.6%</span>
                                </div>
                                <div class="kpi-subtitle" id="port-npl-sub">Industry avg: 3.2%</div>
                            </div>
                        </div>
                    </div>

                    <!-- Portfolio Breakdown -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 24px;">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Portfolio by Loan Product Type</div>
                                    <div class="chart-subtitle">Distribution across product categories</div>
                                </div>
                            </div>
                            <div style="padding: 20px;">
                                <canvas id="portfolioTypeChart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Portfolio by Tenure</div>
                                    <div class="chart-subtitle">Loan maturity distribution</div>
                                </div>
                            </div>
                            <div style="padding: 20px;">
                                <canvas id="tenureChart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Detailed Portfolio Table -->
                    <div class="table-card">
                        <div class="table-header">
                            <div class="table-title">Loan Product Performance</div>
                            <div class="table-actions">
                                <button class="btn btn-secondary">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                    </svg>
                                    Export
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Loan Product Type</th>
                                        <th>Active Loans</th>
                                        <th>Total Value</th>
                                        <th>Avg Ticket Size</th>
                                        <th>At-Risk Count</th>
                                        <th>Risk %</th>
                                        <th>NPL Ratio</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="port-breakdown-table-body">
                                    <tr>
                                        <td><strong>Personal Loan</strong></td>
                                        <td>9,847</td>
                                        <td>₹285.4 Cr</td>
                                        <td>₹2.9 L</td>
                                        <td>842</td>
                                        <td><strong style="color: #f59e0b;">8.6%</strong></td>
                                        <td>3.2%</td>
                                        <td><span class="badge badge-medium">Monitor</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Home Loan</strong></td>
                                        <td>6,234</td>
                                        <td>₹398.7 Cr</td>
                                        <td>₹6.4 L</td>
                                        <td>521</td>
                                        <td><strong style="color: #10b981;">8.4%</strong></td>
                                        <td>2.1%</td>
                                        <td><span class="badge badge-low">Healthy</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Auto Loan</strong></td>
                                        <td>4,892</td>
                                        <td>₹95.6 Cr</td>
                                        <td>₹1.9 L</td>
                                        <td>287</td>
                                        <td><strong style="color: #10b981;">5.9%</strong></td>
                                        <td>2.4%</td>
                                        <td><span class="badge badge-low">Healthy</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Business Loan</strong></td>
                                        <td>2,456</td>
                                        <td>₹52.3 Cr</td>
                                        <td>₹2.1 L</td>
                                        <td>164</td>
                                        <td><strong style="color: #ef4444;">6.7%</strong></td>
                                        <td>4.8%</td>
                                        <td><span class="badge badge-high">Watch</span></td>
                                    </tr>
                                    <tr>
                                        <td><strong>Education Loan</strong></td>
                                        <td>1,153</td>
                                        <td>₹13.2 Cr</td>
                                        <td>₹1.1 L</td>
                                        <td>33</td>
                                        <td><strong style="color: #10b981;">2.9%</strong></td>
                                        <td>1.5%</td>
                                        <td><span class="badge badge-low">Excellent</span></td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Regional Distribution -->
                    <div style="margin-top: 32px;">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Geographic Portfolio Distribution</div>
                                    <div class="chart-subtitle">Top performing regions and branches</div>
                                </div>
                            </div>
                            <div style="padding: 24px;">
                                <div id="port-regional-container"
                                    style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
                                    <div style="padding: 20px; background: #f8f9fb; border-radius: 12px;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                            <div>
                                                <div
                                                    style="font-size: 14px; font-weight: 600; color: #0f172a; margin-bottom: 4px;">
                                                    Mumbai Region</div>
                                                <div style="font-size: 13px; color: #64748b;">5 branches</div>
                                            </div>
                                            <div style="font-size: 24px; font-weight: 700; color: #1e40af;">₹245Cr</div>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 12px;">
                                            <span style="color: #64748b;">Active Loans:</span>
                                            <strong>7,842</strong>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 8px;">
                                            <span style="color: #64748b;">Risk Level:</span>
                                            <strong style="color: #f59e0b;">Medium (7.2%)</strong>
                                        </div>
                                    </div>

                                    <div style="padding: 20px; background: #f8f9fb; border-radius: 12px;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                            <div>
                                                <div
                                                    style="font-size: 14px; font-weight: 600; color: #0f172a; margin-bottom: 4px;">
                                                    Delhi NCR</div>
                                                <div style="font-size: 13px; color: #64748b;">4 branches</div>
                                            </div>
                                            <div style="font-size: 24px; font-weight: 700; color: #1e40af;">₹198Cr</div>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 12px;">
                                            <span style="color: #64748b;">Active Loans:</span>
                                            <strong>6,234</strong>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 8px;">
                                            <span style="color: #64748b;">Risk Level:</span>
                                            <strong style="color: #10b981;">Low (5.8%)</strong>
                                        </div>
                                    </div>

                                    <div style="padding: 20px; background: #f8f9fb; border-radius: 12px;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                            <div>
                                                <div
                                                    style="font-size: 14px; font-weight: 600; color: #0f172a; margin-bottom: 4px;">
                                                    Bangalore</div>
                                                <div style="font-size: 13px; color: #64748b;">6 branches</div>
                                            </div>
                                            <div style="font-size: 24px; font-weight: 700; color: #1e40af;">₹187Cr</div>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 12px;">
                                            <span style="color: #64748b;">Active Loans:</span>
                                            <strong>5,921</strong>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 8px;">
                                            <span style="color: #64748b;">Risk Level:</span>
                                            <strong style="color: #10b981;">Low (6.1%)</strong>
                                        </div>
                                    </div>

                                    <div style="padding: 20px; background: #f8f9fb; border-radius: 12px;">
                                        <div
                                            style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                                            <div>
                                                <div
                                                    style="font-size: 14px; font-weight: 600; color: #0f172a; margin-bottom: 4px;">
                                                    Other Regions</div>
                                                <div style="font-size: 13px; color: #64748b;">12 branches</div>
                                            </div>
                                            <div style="font-size: 24px; font-weight: 700; color: #1e40af;">₹214Cr</div>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 12px;">
                                            <span style="color: #64748b;">Active Loans:</span>
                                            <strong>4,585</strong>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 8px;">
                                            <span style="color: #64748b;">Risk Level:</span>
                                            <strong style="color: #10b981;">Low (6.5%)</strong>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Additional Portfolio Analytics -->
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-top: 32px;">
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Portfolio Growth Trend</div>
                                    <div class="chart-subtitle">Month-over-month portfolio value</div>
                                </div>
                            </div>
                            <div style="padding: 20px;">
                                <canvas id="portfolioGrowthChart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>
                        <div class="chart-card">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Disbursement vs Collection</div>
                                    <div class="chart-subtitle">Last 6 months comparison</div>
                                </div>
                            </div>
                            <div style="padding: 20px;">
                                <canvas id="disbursementChart" style="max-height: 300px;"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- Portfolio Health Metrics -->
                    <div class="chart-card" style="margin-top: 32px;">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Portfolio Health Indicators</div>
                                <div class="chart-subtitle">Key performance metrics across loan products</div>
                            </div>
                        </div>
                        <div style="padding: 24px;">
                            <div id="port-health-container"
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px;">
                                <div
                                    style="text-align: center; padding: 20px; background: linear-gradient(135deg, #dbeafe 0%, #eff6ff 100%); border-radius: 12px;">
                                    <div style="font-size: 48px; font-weight: 800; color: #1e40af; margin-bottom: 8px;">
                                        96.2%</div>
                                    <div style="font-size: 14px; font-weight: 600; color: #475569;">Collection
                                        Efficiency</div>
                                    <div style="font-size: 12px; color: #64748b; margin-top: 4px;">Target: 95%</div>
                                </div>
                                <div
                                    style="text-align: center; padding: 20px; background: linear-gradient(135deg, #d1fae5 0%, #ecfdf5 100%); border-radius: 12px;">
                                    <div style="font-size: 48px; font-weight: 800; color: #065f46; margin-bottom: 8px;">
                                        ₹642Cr</div>
                                    <div style="font-size: 14px; font-weight: 600; color: #475569;">YTD Disbursements
                                    </div>
                                    <div style="font-size: 12px; color: #64748b; margin-top: 4px;">+24% YoY</div>
                                </div>
                                <div
                                    style="text-align: center; padding: 20px; background: linear-gradient(135deg, #fef3c7 0%, #fefce8 100%); border-radius: 12px;">
                                    <div style="font-size: 48px; font-weight: 800; color: #92400e; margin-bottom: 8px;">
                                        2.1%</div>
                                    <div style="font-size: 14px; font-weight: 600; color: #475569;">Average ROI</div>
                                    <div style="font-size: 12px; color: #64748b; margin-top: 4px;">Industry: 1.8%</div>
                                </div>
                                <div
                                    style="text-align: center; padding: 20px; background: linear-gradient(135deg, #e0e7ff 0%, #eef2ff 100%); border-radius: 12px;">
                                    <div style="font-size: 48px; font-weight: 800; color: #3730a3; margin-bottom: 8px;">
                                        18.5M</div>
                                    <div style="font-size: 14px; font-weight: 600; color: #475569;">Active Customers
                                    </div>
                                    <div style="font-size: 12px; color: #64748b; margin-top: 4px;">+12% growth</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PAGE 3: CUSTOMER PROFILE LOOKUP -->
                <div id="page-customer" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Customer Profile Lookup</h1>
                        <p class="page-subtitle">Search and analyze individual customer risk profiles</p>
                    </div>

                    <!-- Customer Search Section -->
                    <div class="chart-card" style="margin-bottom: 32px;">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Customer Lookup</div>
                                <div class="chart-subtitle">Enter customer details to view risk profile</div>
                            </div>
                        </div>
                        <div style="padding: 24px;">
                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px;">
                                <div>
                                    <label
                                        style="display: block; font-size: 13px; font-weight: 600; color: #475569; margin-bottom: 8px;">Customer
                                        ID *</label>
                                    <input type="text" id="customerIdInput" placeholder="e.g., CUS-15847"
                                        style="width: 100%; padding: 12px 16px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; outline: none; transition: border 0.2s;"
                                        onfocus="this.style.borderColor='#3b82f6'"
                                        onblur="this.style.borderColor='#e2e8f0'">
                                </div>
                                <div>
                                    <label
                                        style="display: block; font-size: 13px; font-weight: 600; color: #475569; margin-bottom: 8px;">Customer
                                        Name (Optional)</label>
                                    <input type="text" id="customerNameInput" placeholder="e.g., Rajesh Kumar"
                                        style="width: 100%; padding: 12px 16px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; outline: none; transition: border 0.2s;"
                                        onfocus="this.style.borderColor='#3b82f6'"
                                        onblur="this.style.borderColor='#e2e8f0'">
                                </div>
                                <div>
                                    <label
                                        style="display: block; font-size: 13px; font-weight: 600; color: #475569; margin-bottom: 8px;">Phone
                                        Number (Optional)</label>
                                    <input type="text" id="customerPhoneInput" placeholder="e.g., +91 98765 43210"
                                        style="width: 100%; padding: 12px 16px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px; outline: none; transition: border 0.2s;"
                                        onfocus="this.style.borderColor='#3b82f6'"
                                        onblur="this.style.borderColor='#e2e8f0'">
                                </div>
                            </div>
                            <div style="display: flex; gap: 12px; align-items: center;">
                                <button class="btn btn-primary" onclick="searchCustomer()" style="padding: 12px 32px;">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24"
                                        style="margin-right: 8px;">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                    </svg>
                                    Search Customer
                                </button>
                                <button class="btn btn-secondary" onclick="clearCustomerSearch()"
                                    style="padding: 12px 24px;">Clear</button>
                                <div id="searchStatus" style="font-size: 13px; color: #64748b; margin-left: 12px;">
                                </div>
                            </div>
                            <div style="margin-top: 20px; padding-top: 20px; border-top: 1px solid #e2e8f0;">
                                <div style="font-size: 13px; font-weight: 600; color: #64748b; margin-bottom: 12px;">
                                    Quick Access (Sample Customers):</div>
                                <div style="display: flex; gap: 12px; flex-wrap: wrap;">
                                    <button class="btn btn-secondary" onclick="quickLoadCustomer('CUS-15847')"
                                        style="padding: 8px 16px; font-size: 13px;">
                                        CUS-15847 (High Risk)
                                    </button>
                                    <button class="btn btn-secondary" onclick="quickLoadCustomer('CUS-18234')"
                                        style="padding: 8px 16px; font-size: 13px;">
                                        CUS-18234 (Critical)
                                    </button>
                                    <button class="btn btn-secondary" onclick="quickLoadCustomer('CUS-12903')"
                                        style="padding: 8px 16px; font-size: 13px;">
                                        CUS-12903 (High Risk)
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Details Section (Initially Hidden) -->
                    <div id="customerDetailsSection" style="display: none;">
                        <div
                            style="background: #f8f9fb; padding: 16px 24px; border-radius: 12px; margin-bottom: 24px; border-left: 4px solid #3b82f6;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-size: 18px; font-weight: 700; color: #0f172a; margin-bottom: 4px;">
                                        Showing results for: <span id="displayCustomerId"></span>
                                    </div>
                                    <div style="font-size: 14px; color: #64748b;">
                                        Customer Name: <strong id="displayCustomerName"></strong>
                                    </div>
                                </div>
                                <button class="btn btn-secondary" onclick="clearCustomerSearch()"
                                    style="padding: 8px 20px;">
                                    Search Another Customer
                                </button>
                            </div>
                        </div>

                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin-bottom: 32px;"
                            id="customerRiskCards">
                            <!-- Risk Score Gauge -->
                            <div class="chart-card">
                                <div class="chart-header">
                                    <div>
                                        <div class="chart-title">Overall Risk Score</div>
                                        <div class="chart-subtitle">Calculated using ML prediction model</div>
                                    </div>
                                </div>
                                <div class="risk-gauge-container">
                                    <div class="risk-gauge">
                                        <canvas id="riskGaugeChart"></canvas>
                                        <div class="gauge-score">
                                            <div class="gauge-value">73</div>
                                            <div class="gauge-label">High Risk</div>
                                        </div>
                                    </div>
                                </div>
                                <div
                                    style="padding: 0 24px 24px; display: grid; grid-template-columns: 1fr 1fr; gap: 16px;">
                                    <div>
                                        <div style="font-size: 13px; color: #64748b; margin-bottom: 4px;">Delinquency
                                            Probability</div>
                                        <div style="font-size: 20px; font-weight: 700; color: #ef4444;">68.5%</div>
                                    </div>
                                    <div>
                                        <div style="font-size: 13px; color: #64748b; margin-bottom: 4px;">Confidence
                                            Score</div>
                                        <div style="font-size: 20px; font-weight: 700; color: #0f172a;">91.2%</div>
                                    </div>
                                </div>
                            </div>

                            <!-- Customer Overview -->
                            <div class="chart-card">
                                <div class="chart-header">
                                    <div>
                                        <div class="chart-title">Customer Overview</div>
                                        <div class="chart-subtitle">Account details and loan information</div>
                                    </div>
                                </div>
                                <div style="padding: 20px 0;">
                                    <div style="display: grid; gap: 16px; padding: 0 24px;">
                                        <div
                                            style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                            <span style="color: #64748b; font-size: 14px;">Customer Name</span>
                                            <span style="font-weight: 600; font-size: 14px;">Rajesh Kumar Sharma</span>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                            <span style="color: #64748b; font-size: 14px;">Loan Type</span>
                                            <span style="font-weight: 600; font-size: 14px;">Personal Loan</span>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                            <span style="color: #64748b; font-size: 14px;">Outstanding Amount</span>
                                            <span style="font-weight: 600; font-size: 14px;">₹4,85,000</span>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                            <span style="color: #64748b; font-size: 14px;">Monthly EMI</span>
                                            <span style="font-weight: 600; font-size: 14px;">₹18,500</span>
                                        </div>
                                        <div
                                            style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                            <span style="color: #64748b; font-size: 14px;">Account Age</span>
                                            <span style="font-weight: 600; font-size: 14px;">28 months</span>
                                        </div>
                                        <div style="display: flex; justify-content: space-between; padding: 12px 0;">
                                            <span style="color: #64748b; font-size: 14px;">Branch</span>
                                            <span style="font-weight: 600; font-size: 14px;">Mumbai Central</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Risk Drivers -->
                        <div class="chart-card" style="margin-bottom: 24px;">
                            <div class="chart-header">
                                <div>
                                    <div class="chart-title">Risk Driver Analysis</div>
                                    <div class="chart-subtitle">Factors contributing to elevated risk score</div>
                                </div>
                            </div>
                            <div style="padding: 24px;">
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="font-size: 14px; font-weight: 600;">Income Drop (Last 3
                                            months)</span>
                                        <span style="font-size: 14px; font-weight: 700; color: #ef4444;">-35%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill"
                                            style="width: 85%; background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);">
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="font-size: 14px; font-weight: 600;">High Credit Utilization</span>
                                        <span style="font-size: 14px; font-weight: 700; color: #f97316;">92%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill"
                                            style="width: 92%; background: linear-gradient(90deg, #f97316 0%, #ea580c 100%);">
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="font-size: 14px; font-weight: 600;">Spending Spike
                                            (Discretionary)</span>
                                        <span style="font-size: 14px; font-weight: 700; color: #f59e0b;">+48%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill"
                                            style="width: 70%; background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%);">
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-bottom: 20px;">
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="font-size: 14px; font-weight: 600;">EMI Bounce History</span>
                                        <span style="font-size: 14px; font-weight: 700; color: #f59e0b;">2 in 6
                                            months</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill"
                                            style="width: 65%; background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%);">
                                        </div>
                                    </div>
                                </div>
                                <div>
                                    <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                        <span style="font-size: 14px; font-weight: 600;">Account Balance Dip</span>
                                        <span style="font-size: 14px; font-weight: 700; color: #eab308;">-42%</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill"
                                            style="width: 55%; background: linear-gradient(90deg, #eab308 0%, #ca8a04 100%);">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Bottom Row -->
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                            <!-- Behavioral Timeline -->
                            <div class="chart-card">
                                <div class="chart-header">
                                    <div>
                                        <div class="chart-title">Behavioral Timeline</div>
                                        <div class="chart-subtitle">Recent financial events and patterns</div>
                                    </div>
                                </div>
                                <div class="timeline">
                                    <div class="timeline-item">
                                        <div class="timeline-dot" style="background: #fecaca; color: #991b1b;">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                                <path
                                                    d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z" />
                                                <path
                                                    d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z" />
                                            </svg>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">EMI Payment Missed</div>
                                            <div class="timeline-desc">February EMI bounced - insufficient funds</div>
                                            <div class="timeline-date">Feb 05, 2026</div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-dot" style="background: #fed7aa; color: #92400e;">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                                <path
                                                    d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                                                <path
                                                    d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
                                            </svg>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">Salary Deposit Delayed</div>
                                            <div class="timeline-desc">Monthly salary 15 days late</div>
                                            <div class="timeline-date">Jan 20, 2026</div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-dot" style="background: #fef3c7; color: #92400e;">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                                <path
                                                    d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
                                            </svg>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">High Expenditure Detected</div>
                                            <div class="timeline-desc">₹45,000 discretionary spending spike</div>
                                            <div class="timeline-date">Jan 12, 2026</div>
                                        </div>
                                    </div>
                                    <div class="timeline-item">
                                        <div class="timeline-dot" style="background: #fed7aa; color: #92400e;">
                                            <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                                <path
                                                    d="M0 3a2 2 0 0 1 2-2h13.5a.5.5 0 0 1 0 1H15v2a1 1 0 0 1 1 1v8.5a1.5 1.5 0 0 1-1.5 1.5h-12A2.5 2.5 0 0 1 0 12.5V3zm1 1.732V12.5A1.5 1.5 0 0 0 2.5 14h12a.5.5 0 0 0 .5-.5V5H2a1.99 1.99 0 0 1-1-.268zM1 3a1 1 0 0 0 1 1h12V2H2a1 1 0 0 0-1 1z" />
                                            </svg>
                                        </div>
                                        <div class="timeline-content">
                                            <div class="timeline-title">Account Balance Low</div>
                                            <div class="timeline-desc">Balance below ₹5,000 for 10+ days</div>
                                            <div class="timeline-date">Dec 28, 2025</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Recommended Actions -->
                            <div class="action-panel">
                                <div class="chart-header" style="margin-bottom: 20px;">
                                    <div>
                                        <div class="chart-title">Recommended Actions</div>
                                        <div class="chart-subtitle">Proactive interventions to prevent delinquency</div>
                                    </div>
                                </div>
                                <div class="action-item" style="border-color: #ef4444; background: #fef2f2;">
                                    <div class="action-title">🔴 Immediate: Send Payment Reminder</div>
                                    <div class="action-meta">
                                        <span><strong>Urgency:</strong> Critical</span>
                                        <span><strong>Impact:</strong> 12-15% recovery</span>
                                    </div>
                                </div>
                                <div class="action-item">
                                    <div class="action-title">📞 Assign Relationship Manager</div>
                                    <div class="action-meta">
                                        <span><strong>Urgency:</strong> High</span>
                                        <span><strong>Impact:</strong> 18-22% recovery</span>
                                    </div>
                                </div>
                                <div class="action-item">
                                    <div class="action-title">💳 Offer EMI Restructuring</div>
                                    <div class="action-meta">
                                        <span><strong>Urgency:</strong> Medium</span>
                                        <span><strong>Impact:</strong> 25-30% recovery</span>
                                    </div>
                                </div>
                                <div class="action-item">
                                    <div class="action-title">⏰ Provide 15-Day Grace Period</div>
                                    <div class="action-meta">
                                        <span><strong>Urgency:</strong> Medium</span>
                                        <span><strong>Impact:</strong> 8-12% recovery</span>
                                    </div>
                                </div>
                                <div style="margin-top: 20px; display: flex; gap: 12px;">
                                    <button class="btn btn-primary" style="flex: 1;">Execute All Actions</button>
                                    <button class="btn btn-secondary">Customize Plan</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- End of Customer Details Section -->
                </div>

                <!-- PAGE 4: OPERATIONS TRACKER -->
                <div id="page-operations" class="page">
                    <div class="page-header">
                        <h1 class="page-title">User Operation Tracker</h1>
                        <p class="page-subtitle">Manage daily interventions and track customer engagement</p>
                    </div>

                    <!-- Filter Panel -->
                    <div class="filter-panel">
                        <div class="filter-grid">
                            <div class="filter-group">
                                <label>Branch</label>
                                <select>
                                    <option>All Branches</option>
                                    <option>Mumbai Central</option>
                                    <option>Delhi NCR</option>
                                    <option>Bangalore Tech Park</option>
                                    <option>Pune Hinjewadi</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Loan Product Type</label>
                                <select>
                                    <option>All Types</option>
                                    <option>Personal Loan</option>
                                    <option>Home Loan</option>
                                    <option>Auto Loan</option>
                                    <option>Business Loan</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Risk Level</label>
                                <select>
                                    <option>All Levels</option>
                                    <option>Critical</option>
                                    <option>High</option>
                                    <option>Medium</option>
                                    <option>Low</option>
                                </select>
                            </div>
                            <div class="filter-group">
                                <label>Action Status</label>
                                <select>
                                    <option>All Status</option>
                                    <option>Pending</option>
                                    <option>In Progress</option>
                                    <option>Completed</option>
                                    <option>Escalated</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <!-- Customer Table -->
                    <div class="table-card">
                        <div class="table-header">
                            <div class="table-title">At-Risk Customer Portfolio</div>
                            <div class="table-actions">
                                <button class="btn btn-secondary">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path>
                                    </svg>
                                    Export CSV
                                </button>
                                <button class="btn btn-primary">
                                    <svg width="16" height="16" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                            d="M12 4v16m8-8H4"></path>
                                    </svg>
                                    Bulk Action
                                </button>
                            </div>
                        </div>
                        <div class="table-container">
                            <table>
                                <thead>
                                    <tr>
                                        <th>Customer ID</th>
                                        <th>Name</th>
                                        <th>Loan Product Type</th>
                                        <th>Risk Score</th>
                                        <th>Probability</th>
                                        <th>Recommended Action</th>
                                        <th>Status</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="ops-customer-table-body">
                                    <tr style="cursor: pointer;" onclick="showPage('customer')">
                                        <td><strong>CUS-15847</strong></td>
                                        <td>Rajesh Kumar Sharma</td>
                                        <td>Personal Loan</td>
                                        <td><span class="badge badge-high">73</span></td>
                                        <td><strong style="color: #ef4444;">68.5%</strong></td>
                                        <td>Assign RM + Restructure</td>
                                        <td><span class="badge badge-medium">In Progress</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-18234</strong></td>
                                        <td>Priya Desai</td>
                                        <td>Home Loan</td>
                                        <td><span class="badge badge-critical">82</span></td>
                                        <td><strong style="color: #dc2626;">79.2%</strong></td>
                                        <td>Immediate Contact</td>
                                        <td><span class="badge badge-high">Pending</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-12903</strong></td>
                                        <td>Amit Patel</td>
                                        <td>Auto Loan</td>
                                        <td><span class="badge badge-high">71</span></td>
                                        <td><strong style="color: #ef4444;">65.8%</strong></td>
                                        <td>Send Reminder</td>
                                        <td><span class="badge badge-low">Completed</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-19475</strong></td>
                                        <td>Sanjay Mehta</td>
                                        <td>Business Loan</td>
                                        <td><span class="badge badge-critical">85</span></td>
                                        <td><strong style="color: #dc2626;">82.1%</strong></td>
                                        <td>Grace Period + RM</td>
                                        <td><span class="badge badge-medium">In Progress</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-14582</strong></td>
                                        <td>Neha Agarwal</td>
                                        <td>Personal Loan</td>
                                        <td><span class="badge badge-medium">58</span></td>
                                        <td><strong style="color: #f59e0b;">52.3%</strong></td>
                                        <td>Monitor Closely</td>
                                        <td><span class="badge badge-medium">In Progress</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-17629</strong></td>
                                        <td>Vikram Singh</td>
                                        <td>Home Loan</td>
                                        <td><span class="badge badge-high">76</span></td>
                                        <td><strong style="color: #ef4444;">71.4%</strong></td>
                                        <td>Offer Restructuring</td>
                                        <td><span class="badge badge-high">Pending</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-13847</strong></td>
                                        <td>Kavita Reddy</td>
                                        <td>Auto Loan</td>
                                        <td><span class="badge badge-medium">62</span></td>
                                        <td><strong style="color: #f97316;">56.7%</strong></td>
                                        <td>Send Reminder</td>
                                        <td><span class="badge badge-low">Completed</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                    <tr style="cursor: pointer;">
                                        <td><strong>CUS-16274</strong></td>
                                        <td>Arjun Nair</td>
                                        <td>Personal Loan</td>
                                        <td><span class="badge badge-high">69</span></td>
                                        <td><strong style="color: #ef4444;">63.9%</strong></td>
                                        <td>Assign RM</td>
                                        <td><span class="badge badge-medium">In Progress</span></td>
                                        <td>
                                            <button class="btn btn-secondary"
                                                style="padding: 6px 12px; font-size: 12px;">View</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                        <div
                            style="padding: 16px 24px; border-top: 1px solid #e2e8f0; display: flex; justify-content: between; align-items: center;">
                            <div style="font-size: 14px; color: #64748b;">Showing 1-8 of 1,847 customers</div>
                            <div style="display: flex; gap: 8px;">
                                <button class="btn btn-secondary" style="padding: 8px 16px;">Previous</button>
                                <button class="btn btn-secondary" style="padding: 8px 16px;">1</button>
                                <button class="btn btn-primary" style="padding: 8px 16px;">2</button>
                                <button class="btn btn-secondary" style="padding: 8px 16px;">3</button>
                                <button class="btn btn-secondary" style="padding: 8px 16px;">Next</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PAGE 4: MODEL MONITORING -->
                <div id="page-model" class="page">
                    <div class="page-header">
                        <h1 class="page-title">Model Monitoring</h1>
                        <p class="page-subtitle">Performance metrics and data drift analysis</p>
                    </div>

                    <!-- Metric Cards -->
                    <div class="metric-grid">
                        <div class="metric-card">
                            <div class="metric-header">
                                <div>
                                    <div class="metric-label">Model Accuracy</div>
                                    <div class="metric-value-large" id="model-accuracy-value">89.4%</div>
                                    <div style="display: flex; align-items: center; gap: 6px; margin-top: 8px;">
                                        <span id="model-accuracy-trend"
                                            style="color: #10b981; font-size: 13px; font-weight: 600;">↑ 2.1%</span>
                                        <span id="model-accuracy-desc" style="color: #64748b; font-size: 13px;">vs last
                                            month</span>
                                    </div>
                                </div>
                                <div class="metric-icon" style="background: #dbeafe; color: #1e40af;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z" />
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <div>
                                    <div class="metric-label">AUC-ROC Score</div>
                                    <div class="metric-value-large" id="model-auc-value">0.924</div>
                                    <div style="display: flex; align-items: center; gap: 6px; margin-top: 8px;">
                                        <span id="model-auc-trend"
                                            style="color: #10b981; font-size: 13px; font-weight: 600;">↑ 0.018</span>
                                        <span id="model-auc-desc" style="color: #64748b; font-size: 13px;">Excellent
                                            performance</span>
                                    </div>
                                </div>
                                <div class="metric-icon" style="background: #d1fae5; color: #065f46;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M4 11H2v3h2v-3zm5-4H7v7h2V7zm5-5v12h-2V2h2zm-2-1a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1h-2zM6 7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7a1 1 0 0 1-1 1H7a1 1 0 0 1-1-1V7zm-5 4a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1v-3z" />
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <div>
                                    <div class="metric-label">False Negative Rate</div>
                                    <div class="metric-value-large" id="model-fnr-value">4.8%</div>
                                    <div style="display: flex; align-items: center; gap: 6px; margin-top: 8px;">
                                        <span id="model-fnr-trend"
                                            style="color: #10b981; font-size: 13px; font-weight: 600;">↓ 1.2%</span>
                                        <span id="model-fnr-desc" style="color: #64748b; font-size: 13px;">Within
                                            threshold</span>
                                    </div>
                                </div>
                                <div class="metric-icon" style="background: #fef3c7; color: #92400e;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z" />
                                        <path
                                            d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 5.995z" />
                                    </svg>
                                </div>
                            </div>
                        </div>

                        <div class="metric-card">
                            <div class="metric-header">
                                <div>
                                    <div class="metric-label">Last Retrained</div>
                                    <div class="metric-value-large" id="model-last-trained-value"
                                        style="font-size: 24px;">Feb 1</div>
                                    <div style="display: flex; align-items: center; gap: 6px; margin-top: 8px;">
                                        <span id="model-last-trained-trend"
                                            style="color: #64748b; font-size: 13px; font-weight: 600;">14 days
                                            ago</span>
                                        <span id="model-last-trained-desc"
                                            style="color: #64748b; font-size: 13px;">Next: Feb 28</span>
                                    </div>
                                </div>
                                <div class="metric-icon" style="background: #e0e7ff; color: #3730a3;">
                                    <svg width="24" height="24" fill="currentColor" viewBox="0 0 16 16">
                                        <path
                                            d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z" />
                                        <path
                                            d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z" />
                                    </svg>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Model Performance Chart -->
                    <div class="chart-card" style="margin-bottom: 24px;">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Model Performance Over Time</div>
                                <div class="chart-subtitle">Accuracy and precision metrics tracking</div>
                            </div>
                        </div>
                        <canvas id="modelPerfChart"></canvas>
                    </div>

                    <!-- Data Drift Analysis -->
                    <div class="chart-card">
                        <div class="chart-header">
                            <div>
                                <div class="chart-title">Data Drift Monitoring</div>
                                <div class="chart-subtitle">Feature distribution changes and alerts</div>
                            </div>
                        </div>
                        <div style="padding: 24px;">
                            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px;">
                                <div id="model-drift-alerts">
                                    <div
                                        style="padding: 16px; background: #fef2f2; border: 1px solid #fecaca; border-radius: 8px; margin-bottom: 16px;">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                            <span style="font-size: 24px;">⚠️</span>
                                            <div>
                                                <div style="font-size: 14px; font-weight: 600; color: #991b1b;">Moderate
                                                    Drift Detected</div>
                                                <div style="font-size: 13px; color: #7f1d1d;">Income distribution shift
                                                </div>
                                            </div>
                                        </div>
                                        <div style="font-size: 13px; color: #991b1b; margin-top: 8px;">
                                            PSI Score: 0.18 • Threshold: 0.15
                                        </div>
                                    </div>

                                    <div
                                        style="padding: 16px; background: #fffbeb; border: 1px solid #fef3c7; border-radius: 8px;">
                                        <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                            <span style="font-size: 24px;">⚡</span>
                                            <div>
                                                <div style="font-size: 14px; font-weight: 600; color: #92400e;">Minor
                                                    Drift</div>
                                                <div style="font-size: 13px; color: #78350f;">Credit utilization pattern
                                                </div>
                                            </div>
                                        </div>
                                        <div style="font-size: 13px; color: #92400e; margin-top: 8px;">
                                            PSI Score: 0.11 • Threshold: 0.15
                                        </div>
                                    </div>
                                </div>

                                <div id="model-drift-features">
                                    <div style="margin-bottom: 20px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span style="font-size: 14px; font-weight: 600;">Income Feature</span>
                                            <span
                                                style="font-size: 14px; font-weight: 700; color: #ef4444;">Drifting</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill"
                                                style="width: 72%; background: linear-gradient(90deg, #ef4444 0%, #dc2626 100%);">
                                            </div>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: 20px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span style="font-size: 14px; font-weight: 600;">Credit Utilization</span>
                                            <span
                                                style="font-size: 14px; font-weight: 700; color: #f59e0b;">Monitoring</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill"
                                                style="width: 44%; background: linear-gradient(90deg, #f59e0b 0%, #d97706 100%);">
                                            </div>
                                        </div>
                                    </div>

                                    <div style="margin-bottom: 20px;">
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span style="font-size: 14px; font-weight: 600;">EMI History</span>
                                            <span
                                                style="font-size: 14px; font-weight: 700; color: #10b981;">Stable</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill"
                                                style="width: 18%; background: linear-gradient(90deg, #10b981 0%, #059669 100%);">
                                            </div>
                                        </div>
                                    </div>

                                    <div>
                                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                            <span style="font-size: 14px; font-weight: 600;">Account Balance</span>
                                            <span
                                                style="font-size: 14px; font-weight: 700; color: #10b981;">Stable</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill"
                                                style="width: 12%; background: linear-gradient(90deg, #10b981 0%, #059669 100%);">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div
                                style="margin-top: 24px; padding-top: 24px; border-top: 1px solid #e2e8f0; display: flex; justify-content: space-between; align-items: center;">
                                <div style="font-size: 13px; color: #64748b;">
                                    Last checked: Feb 15, 2026 08:45 AM • Next check: Feb 16, 2026 08:00 AM
                                </div>
                                <button class="btn btn-primary">Review & Retrain Model</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Show alert details in modal
        function showAlertDetails(alertType) {
            const alerts = {
                critical: {
                    title: 'High Risk Account Review Required',
                    details: `
                        <p style="margin-bottom: 16px;"><strong>What happened:</strong><br>
                        We've identified 23 customer accounts that have moved into the critical risk category over the past 24 hours. Their combined outstanding balance is around ₹45.2 crores.</p>
                        
                        <p style="margin-bottom: 16px;"><strong>Who's affected:</strong><br>
                        • 8 accounts scoring between 85-90 (total exposure: ₹12.4 Cr)<br>
                        • 15 accounts scoring between 80-85 (total exposure: ₹32.8 Cr)</p>
                        
                        <p style="margin-bottom: 16px;"><strong>Most urgent cases:</strong><br>
                        • Customer CUS-18234: Score jumped to 82 (₹28.5L outstanding)<br>
                        • Customer CUS-19475: Now at 85 (₹15.2L outstanding)<br>
                        • Customer CUS-20156: Reached 83 (₹22.8L outstanding)</p>
                        
                        <p style="margin-bottom: 0;"><strong>Next steps:</strong><br>
                        The team should reach out to these customers today. Priority should be the top 3 accounts listed above. Consider offering payment plans or restructuring options where appropriate.</p>
                    `,
                    color: '#dc2626'
                },
                warning: {
                    title: 'Model Performance Check',
                    details: `
                        <p style="margin-bottom: 16px;"><strong>What we noticed:</strong><br>
                        The income distribution feature in our risk model has started drifting. The PSI score hit 0.18 yesterday (our threshold is 0.15), which means customer income patterns have shifted from what the model was trained on.</p>
                        
                        <p style="margin-bottom: 16px;"><strong>Why this matters:</strong><br>
                        This could affect prediction accuracy by 2-3% over the next few weeks. About 156 customers fall into the affected segment. We might start seeing more false negatives if we don't address this soon.</p>
                        
                        <p style="margin-bottom: 16px;"><strong>What's causing it:</strong><br>
                        Likely a combination of economic changes, seasonal employment patterns, and new customer segments we've been serving. Nothing alarming, just natural market evolution.</p>
                        
                        <p style="margin-bottom: 0;"><strong>Recommendation:</strong><br>
                        Let's schedule a model retraining session within the next week. We should update the training dataset with recent data and run validation tests before deploying.</p>
                    `,
                    color: '#f59e0b'
                },
                info: {
                    title: 'Good News on Collections',
                    details: `
                        <p style="margin-bottom: 16px;"><strong>Performance this month:</strong><br>
                        Our collection efficiency is at 96.2%, which beats our 95% target. We collected ₹118 crores against a target of ₹112 crores. That's pretty solid performance.</p>
                        
                        <p style="margin-bottom: 16px;"><strong>What's working:</strong><br>
                        The early intervention approach we implemented last quarter is really paying off. RM engagement is up 24%, and customers are responding better to our automated reminders. The response rate increased by 15% month-over-month.</p>
                        
                        <p style="margin-bottom: 16px;"><strong>Other positives:</strong><br>
                        • Recovery rate improved to 18.9% (up 6.2% from last month)<br>
                        • Our intervention success rate is holding at 76.3%<br>
                        • Overall delinquency rate continues to trend downward</p>
                        
                        <p style="margin-bottom: 0;"><strong>Keep it up:</strong><br>
                        No major changes needed. Let's stick with the current strategy and maybe look at scaling what's working to other regions.</p>
                    `,
                    color: '#3b82f6'
                }
            };

            const alert = alerts[alertType];
            const modal = `
                <div style="position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 10000; display: flex; align-items: center; justify-content: center; animation: fadeIn 0.2s;" onclick="this.remove()">
                    <div style="background: white; border-radius: 12px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 20px 60px rgba(0,0,0,0.25); animation: slideUp 0.3s;" onclick="event.stopPropagation()">
                        <div style="padding: 24px; border-bottom: 1px solid #e5e7eb;">
                            <div style="display: flex; justify-content: space-between; align-items: start;">
                                <h2 style="font-size: 18px; font-weight: 600; color: #111827; margin: 0; line-height: 1.4;">${alert.title}</h2>
                                <button onclick="this.closest('[style*=fixed]').remove()" style="background: #f3f4f6; border: none; width: 32px; height: 32px; border-radius: 6px; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: background 0.2s;" onmouseover="this.style.background='#e5e7eb'" onmouseout="this.style.background='#f3f4f6'">
                                    <svg width="14" height="14" fill="#6b7280" viewBox="0 0 16 16">
                                        <path d="M2.146 2.854a.5.5 0 1 1 .708-.708L8 7.293l5.146-5.147a.5.5 0 0 1 .708.708L8.707 8l5.147 5.146a.5.5 0 0 1-.708.708L8 8.707l-5.146 5.147a.5.5 0 0 1-.708-.708L7.293 8 2.146 2.854Z"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div style="padding: 24px; line-height: 1.6; color: #374151; font-size: 14px;">
                            ${alert.details}
                        </div>
                        <div style="padding: 16px 24px; border-top: 1px solid #e5e7eb; display: flex; gap: 10px; justify-content: flex-end;">
                            <button onclick="this.closest('[style*=fixed]').remove()" class="btn btn-secondary" style="padding: 9px 18px;">Dismiss</button>
                            <button onclick="alert('Got it! The recommended actions will be queued for the team.'); this.closest('[style*=fixed]').remove();" class="btn btn-primary" style="padding: 9px 18px;">Acknowledge</button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modal);
        }

        // Navigation
        function showPage(pageName) {
            // Hide all pages
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => {
                page.classList.remove('active');
            });

            // Show selected page
            const targetPage = document.getElementById('page-' + pageName);
            if (targetPage) {
                targetPage.classList.add('active');

                // Trigger data load based on page
                if (pageName === 'portfolio') loadPortfolioData();
                if (pageName === 'operations') loadOperationsData();
                if (pageName === 'model') loadModelData();
            }

            // Update nav items
            const navItems = document.querySelectorAll('.nav-item');
            navItems.forEach(item => {
                item.classList.remove('active');
                const itemPage = item.getAttribute('data-page');
                if (itemPage === pageName) {
                    item.classList.add('active');
                }
            });
        }

        // Initialize Charts
        Chart.defaults.font.family = '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif';
        Chart.defaults.color = '#64748b';

        // Risk Distribution Doughnut Chart
        const riskDistCtx = document.getElementById('riskDistChart').getContext('2d');
        new Chart(riskDistCtx, {
            type: 'doughnut',
            data: {
                labels: ['Low Risk', 'Medium Risk', 'High Risk', 'Critical'],
                datasets: [{
                    data: [15234, 6421, 2105, 822],
                    backgroundColor: [
                        'rgba(16, 185, 129, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(220, 38, 38, 0.9)'
                    ],
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            font: { size: 13, weight: 500 }
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(15, 23, 42, 0.9)',
                        padding: 12,
                        cornerRadius: 8,
                        titleFont: { size: 14, weight: 600 },
                        bodyFont: { size: 13 }
                    }
                }
            }
        });

        // Risk Trend Line Chart
        const riskTrendCtx = document.getElementById('riskTrendChart').getContext('2d');
        new Chart(riskTrendCtx, {
            type: 'line',
            data: {
                labels: ['Aug', 'Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                datasets: [{
                    label: 'Without Intervention',
                    data: [6.2, 6.8, 7.2, 7.5, 7.8, 8.1, 8.4],
                    borderColor: '#ef4444',
                    backgroundColor: 'rgba(239, 68, 68, 0.08)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: '#ef4444',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointHoverBackgroundColor: '#dc2626',
                    pointHoverBorderColor: '#fff',
                    pointHoverBorderWidth: 3
                }, {
                    label: 'With Intervention (Actual)',
                    data: [6.2, 6.5, 6.3, 6.1, 5.8, 5.2, 4.2],
                    borderColor: '#3b82f6',
                    backgroundColor: 'rgba(59, 130, 246, 0.08)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3,
                    pointRadius: 5,
                    pointHoverRadius: 7,
                    pointBackgroundColor: '#3b82f6',
                    pointBorderColor: '#fff',
                    pointBorderWidth: 2,
                    pointHoverBackgroundColor: '#2563eb',
                    pointHoverBorderColor: '#fff',
                    pointHoverBorderWidth: 3
                }, {
                    label: 'Target',
                    data: [6.0, 6.0, 6.0, 6.0, 6.0, 6.0, 6.0],
                    borderColor: '#10b981',
                    backgroundColor: 'transparent',
                    borderDash: [8, 4],
                    tension: 0,
                    fill: false,
                    borderWidth: 2,
                    pointRadius: 0,
                    pointHoverRadius: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                interaction: {
                    mode: 'index',
                    intersect: false,
                },
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            font: { size: 13, weight: 500 },
                            usePointStyle: true,
                            pointStyle: 'circle',
                            boxWidth: 8,
                            boxHeight: 8
                        }
                    },
                    tooltip: {
                        backgroundColor: 'rgba(15, 23, 42, 0.95)',
                        padding: 12,
                        cornerRadius: 8,
                        titleFont: { size: 14, weight: 600 },
                        bodyFont: { size: 13 },
                        bodySpacing: 6,
                        callbacks: {
                            label: function (context) {
                                let label = context.dataset.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                label += context.parsed.y.toFixed(1) + '%';
                                return label;
                            },
                            afterBody: function (context) {
                                if (context[0].dataIndex === 6) { // Feb (latest)
                                    const withIntervention = context[0].dataset.label.includes('Actual');
                                    const withoutIntervention = context[0].dataset.label.includes('Without');
                                    if (withIntervention) {
                                        return ['\nImprovement: -4.2% vs projected'];
                                    } else if (withoutIntervention) {
                                        return ['\nProjected without action'];
                                    }
                                }
                                return '';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        max: 10,
                        ticks: {
                            callback: function (value) {
                                return value + '%';
                            },
                            font: {
                                size: 12
                            },
                            color: '#64748b'
                        },
                        grid: {
                            color: 'rgba(226, 232, 240, 0.5)',
                            drawBorder: false
                        },
                        border: {
                            display: false
                        }
                    },
                    x: {
                        grid: {
                            display: false,
                            drawBorder: false
                        },
                        ticks: {
                            font: {
                                size: 12
                            },
                            color: '#64748b'
                        },
                        border: {
                            display: false
                        }
                    }
                }
            }
        });

        // Loan Type Bar Chart
        const loanTypeCtx = document.getElementById('loanTypeChart').getContext('2d');
        new Chart(loanTypeCtx, {
            type: 'bar',
            data: {
                labels: ['Personal Loan', 'Home Loan', 'Auto Loan', 'Business Loan', 'Credit Card'],
                datasets: [{
                    label: 'At-Risk Count',
                    data: [842, 521, 287, 164, 33],
                    backgroundColor: [
                        'rgba(59, 130, 246, 0.8)',
                        'rgba(99, 102, 241, 0.8)',
                        'rgba(139, 92, 246, 0.8)',
                        'rgba(168, 85, 247, 0.8)',
                        'rgba(217, 70, 239, 0.8)'
                    ],
                    borderRadius: 6,
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        grid: {
                            color: 'rgba(226, 232, 240, 0.5)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // Regional Chart
        const regionalCtx = document.getElementById('regionalChart').getContext('2d');
        new Chart(regionalCtx, {
            type: 'bar',
            data: {
                labels: ['Mumbai', 'Delhi', 'Bangalore', 'Pune', 'Hyderabad', 'Chennai'],
                datasets: [{
                    label: 'Risk Score',
                    data: [72, 68, 65, 59, 54, 51],
                    backgroundColor: [
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(249, 115, 22, 0.8)',
                        'rgba(245, 158, 11, 0.8)',
                        'rgba(234, 179, 8, 0.8)',
                        'rgba(132, 204, 22, 0.8)',
                        'rgba(34, 197, 94, 0.8)'
                    ],
                    borderRadius: 6,
                    borderWidth: 0
                }]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 100,
                        grid: {
                            color: 'rgba(226, 232, 240, 0.5)'
                        }
                    },
                    y: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // Global variables for charts to be updated dynamically
        let portfolioTypeChart, tenureChart, portfolioGrowthChart, disbursementChart;

        // Risk Gauge (Customer Page - Static for now or updated per customer)
        const gaugeCtx = document.getElementById('riskGaugeChart').getContext('2d');
        new Chart(gaugeCtx, {
            type: 'doughnut',
            data: {
                datasets: [{
                    data: [73, 27],
                    backgroundColor: [
                        'rgba(239, 68, 68, 0.8)',
                        'rgba(226, 232, 240, 0.3)'
                    ],
                    borderWidth: 0,
                    circumference: 180,
                    rotation: 270
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                cutout: '75%',
                plugins: {
                    legend: {
                        display: false
                    },
                    tooltip: {
                        enabled: false
                    }
                }
            }
        });

        // Model Performance Chart
        const modelPerfCtx = document.getElementById('modelPerfChart').getContext('2d');
        new Chart(modelPerfCtx, {
            type: 'line',
            data: {
                labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                datasets: [{
                    label: 'Accuracy',
                    data: [87.2, 87.8, 88.1, 88.5, 89.0, 89.4],
                    borderColor: 'rgba(59, 130, 246, 0.8)',
                    backgroundColor: 'rgba(59, 130, 246, 0.1)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3
                }, {
                    label: 'Precision',
                    data: [85.5, 86.1, 86.8, 87.2, 87.9, 88.3],
                    borderColor: 'rgba(16, 185, 129, 0.8)',
                    backgroundColor: 'rgba(16, 185, 129, 0.1)',
                    tension: 0.4,
                    fill: true,
                    borderWidth: 3
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            padding: 20,
                            font: { size: 13, weight: 500 }
                        }
                    }
                },
                scales: {
                    y: {
                        min: 80,
                        max: 95,
                        ticks: {
                            callback: function (value) {
                                return value + '%';
                            }
                        },
                        grid: {
                            color: 'rgba(226, 232, 240, 0.5)'
                        }
                    },
                    x: {
                        grid: {
                            display: false
                        }
                    }
                }
            }
        });

        // Portfolio Type Chart
        const portfolioTypeCtx = document.getElementById('portfolioTypeChart');
        if (portfolioTypeCtx) {
            portfolioTypeChart = new Chart(portfolioTypeCtx.getContext('2d'), {
                type: 'doughnut',
                data: {
                    labels: ['Personal Loan', 'Home Loan', 'Auto Loan', 'Business Loan', 'Education Loan'],
                    datasets: [{
                        data: [285.4, 398.7, 95.6, 52.3, 13.2], // Initial Placeholder
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.8)',
                            'rgba(16, 185, 129, 0.8)',
                            'rgba(139, 92, 246, 0.8)',
                            'rgba(245, 158, 11, 0.8)',
                            'rgba(236, 72, 153, 0.8)'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: { size: 13, weight: 500 }
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function (context) {
                                    return context.label + ': ₹' + context.parsed + ' Cr';
                                }
                            }
                        }
                    }
                }
            });
        }

        // Tenure Chart
        const tenureCtx = document.getElementById('tenureChart');
        if (tenureCtx) {
            tenureChart = new Chart(tenureCtx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['0-1 Year', '1-3 Years', '3-5 Years', '5-10 Years', '10+ Years'],
                    datasets: [{
                        label: 'Number of Loans',
                        data: [3245, 8967, 6821, 4234, 1315],
                        backgroundColor: 'rgba(59, 130, 246, 0.8)',
                        borderRadius: 8,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(226, 232, 240, 0.5)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Portfolio Growth Chart
        const portfolioGrowthCtx = document.getElementById('portfolioGrowthChart');
        if (portfolioGrowthCtx) {
            portfolioGrowthChart = new Chart(portfolioGrowthCtx.getContext('2d'), {
                type: 'line',
                data: {
                    labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                    datasets: [{
                        label: 'Portfolio Value (₹Cr)',
                        data: [724, 752, 781, 802, 825, 845],
                        borderColor: 'rgba(59, 130, 246, 0.8)',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4,
                        fill: true,
                        borderWidth: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            ticks: {
                                callback: function (value) {
                                    return '₹' + value + ' Cr';
                                }
                            },
                            grid: {
                                color: 'rgba(226, 232, 240, 0.5)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Disbursement vs Collection Chart
        const disbursementCtx = document.getElementById('disbursementChart');
        if (disbursementCtx) {
            disbursementChart = new Chart(disbursementCtx.getContext('2d'), {
                type: 'bar',
                data: {
                    labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
                    datasets: [{
                        label: 'Disbursements',
                        data: [95, 108, 112, 98, 115, 122],
                        backgroundColor: 'rgba(59, 130, 246, 0.8)',
                        borderRadius: 8,
                        borderWidth: 0
                    }, {
                        label: 'Collections',
                        data: [88, 102, 107, 94, 110, 118],
                        backgroundColor: 'rgba(16, 185, 129, 0.8)',
                        borderRadius: 8,
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 15,
                                font: { size: 13, weight: 500 }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                callback: function (value) {
                                    return '₹' + value + ' Cr';
                                }
                            },
                            grid: {
                                color: 'rgba(226, 232, 240, 0.5)'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            }
                        }
                    }
                }
            });
        }

        // Customer Data Cache
        const customers = {}; // Loaded API on demand

        let currentCustomerId = 'CUS-15847';

        // Customer search function
        async function searchCustomer() {
            const customerId = document.getElementById('customerIdInput').value.trim();
            const customerName = document.getElementById('customerNameInput').value.trim();
            const customerPhone = document.getElementById('customerPhoneInput').value.trim();

            const searchStatus = document.getElementById('searchStatus');

            if (!customerId) {
                searchStatus.style.color = '#dc2626';
                searchStatus.textContent = '⚠ Please enter a Customer ID';
                return;
            }

            // Show loading state
            searchStatus.style.color = '#3b82f6';
            searchStatus.textContent = '🔍 Searching...';

            try {
                // Fetch from API
                const response = await fetch(`http://127.0.0.1:8000/api/customers/${customerId}`);

                if (!response.ok) {
                    throw new Error('Customer not found');
                }

                const customerData = await response.json();

                // Cache the data
                customers[customerId] = customerData;

                displayCustomerResults(customerId, customerData);

            } catch (error) {
                searchStatus.style.color = '#dc2626';
                searchStatus.textContent = '❌ Customer not found. Try: CUS-15847, CUS-18234, or CUS-12903';
                console.error(error);
            }
        }

        // Quick load customer function
        function quickLoadCustomer(customerId) {
            document.getElementById('customerIdInput').value = customerId;
            searchCustomer();
        }

        // Display customer results
        function displayCustomerResults(customerId, customerExists) {
            const searchStatus = document.getElementById('searchStatus');

            searchStatus.style.color = '#059669';
            searchStatus.textContent = '✅ Customer found!';

            // Update display
            document.getElementById('displayCustomerId').textContent = customerId;
            document.getElementById('displayCustomerName').textContent = customerExists.name;

            // Show customer details section
            document.getElementById('customerDetailsSection').style.display = 'block';

            // Load customer data
            loadCustomerData(customerId);

            // Scroll to results
            setTimeout(() => {
                document.getElementById('customerDetailsSection').scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }, 100);

            // Clear status after 3 seconds
            setTimeout(() => {
                searchStatus.textContent = '';
            }, 3000);
        }

        // Clear search function
        function clearCustomerSearch() {
            document.getElementById('customerIdInput').value = '';
            document.getElementById('customerNameInput').value = '';
            document.getElementById('customerPhoneInput').value = '';
            document.getElementById('searchStatus').textContent = '';
            document.getElementById('customerDetailsSection').style.display = 'none';

            // Scroll back to top of customer page
            document.getElementById('page-customer').scrollIntoView({
                behavior: 'smooth',
                block: 'start'
            });
        }

        // Allow Enter key to search
        document.addEventListener('DOMContentLoaded', function () {
            const inputs = ['customerIdInput', 'customerNameInput', 'customerPhoneInput'];
            inputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('keypress', function (e) {
                        if (e.key === 'Enter') {
                            searchCustomer();
                        }
                    });
                }
            });
        });

        // Load customer data
        function loadCustomerData(customerId) {
            currentCustomerId = customerId;
            const customer = customers[customerId];
            if (!customer) return;

            // Animate transition
            const customerPage = document.getElementById('page-customer');
            customerPage.style.opacity = '0';

            setTimeout(() => {
                // Update header
                document.querySelector('#page-customer .page-subtitle').textContent =
                    `Detailed risk analysis for customer ID: ${customerId}`;

                // Update overview section
                const overviewSection = document.querySelector('#page-customer .chart-card:nth-child(2)');
                overviewSection.innerHTML = `
                    <div class="chart-header">
                        <div>
                            <div class="chart-title">Customer Overview</div>
                            <div class="chart-subtitle">Account details and loan information</div>
                        </div>
                    </div>
                    <div style="padding: 20px 0;">
                        <div style="display: grid; gap: 16px; padding: 0 24px;">
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                <span style="color: #64748b; font-size: 14px;">Customer Name</span>
                                <span style="font-weight: 600; font-size: 14px;">${customer.name}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                <span style="color: #64748b; font-size: 14px;">Loan Product Type</span>
                                <span style="font-weight: 600; font-size: 14px;">${customer.loanType}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                <span style="color: #64748b; font-size: 14px;">Outstanding Amount</span>
                                <span style="font-weight: 600; font-size: 14px;">${customer.outstanding}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                <span style="color: #64748b; font-size: 14px;">Monthly EMI</span>
                                <span style="font-weight: 600; font-size: 14px;">${customer.emi}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid #f1f5f9;">
                                <span style="color: #64748b; font-size: 14px;">Account Age</span>
                                <span style="font-weight: 600; font-size: 14px;">${customer.age}</span>
                            </div>
                            <div style="display: flex; justify-content: space-between; padding: 12px 0;">
                                <span style="color: #64748b; font-size: 14px;">Branch</span>
                                <span style="font-weight: 600; font-size: 14px;">${customer.branch}</span>
                            </div>
                        </div>
                    </div>
                `;

                // Update risk score
                document.querySelector('.gauge-value').textContent = customer.riskScore;
                document.querySelector('.gauge-label').textContent = customer.riskLevel;
                document.querySelector('#page-customer .chart-card:nth-child(1) > div:last-child > div:first-child > div:last-child').textContent = customer.probability + '%';
                document.querySelector('#page-customer .chart-card:nth-child(1) > div:last-child > div:last-child > div:last-child').textContent = customer.confidence + '%';

                // Update gauge color based on risk
                const gaugeColor = customer.riskScore >= 80 ? '#dc2626' : customer.riskScore >= 70 ? '#ef4444' : '#f97316';
                document.querySelector('.gauge-value').style.color = gaugeColor;

                // Update risk drivers
                const driversContainer = document.querySelector('#page-customer .chart-card:nth-child(3) > div:last-child');
                driversContainer.innerHTML = customer.drivers.map(driver => `
                    <div style="margin-bottom: 20px;">
                        <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                            <span style="font-size: 14px; font-weight: 600;">${driver.name}</span>
                            <span style="font-size: 14px; font-weight: 700; color: ${driver.color};">${typeof driver.value === 'number' ? (driver.value > 0 ? '+' : '') + driver.value + (driver.value > 1 ? '%' : '') : driver.value}</span>
                        </div>
                        <div class="progress-bar">
                            <div class="progress-fill" style="width: ${driver.percent}%; background: linear-gradient(90deg, ${driver.color} 0%, ${driver.color}dd 100%);"></div>
                        </div>
                    </div>
                `).join('');

                // Update timeline
                const timelineContainer = document.querySelector('#page-customer .timeline');
                if (timelineContainer) {
                    timelineContainer.innerHTML = customer.timeline.map((event, index) => {
                        const dotColors = {
                            critical: 'background: #fecaca; color: #991b1b;',
                            warning: 'background: #fed7aa; color: #92400e;',
                            info: 'background: #fef3c7; color: #92400e;'
                        };
                        return `
                            <div class="timeline-item" data-event-index="${index}">
                                <div class="timeline-dot" style="${dotColors[event.type]}">
                                    <svg width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                                        ${event.type === 'critical' ? '<path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/><path d="M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0L7.1 4.995z"/>' : '<path d="M8 3.5a.5.5 0 0 0-1 0V9a.5.5 0 0 0 .252.434l3.5 2a.5.5 0 0 0 .496-.868L8 8.71V3.5z"/><path d="M8 16A8 8 0 1 0 8 0a8 8 0 0 0 0 16zm7-8A7 7 0 1 1 1 8a7 7 0 0 1 14 0z"/>'}
                                    </svg>
                                </div>
                                <div class="timeline-content">
                                    <div class="timeline-title">${event.title}</div>
                                    <div class="timeline-desc">${event.desc}</div>
                                    <div class="timeline-date">${event.date}</div>
                                </div>
                            </div>
                        `;
                    }).join('');

                    // Add click handlers to timeline items
                    timelineContainer.querySelectorAll('.timeline-item').forEach(item => {
                        item.addEventListener('click', function () {
                            const eventIndex = parseInt(this.getAttribute('data-event-index'));
                            const event = customer.timeline[eventIndex];
                            showEventDetail(event.title, event.desc);
                        });
                    });
                }

                customerPage.style.opacity = '1';
            }, 200);
        }

        // Show event detail
        function showEventDetail(title, desc) {
            alert(`${title}\n\n${desc}\n\nClick on recommended actions to take preventive measures.`);
        }

        // Add customer selector
        function addCustomerSelector() {
            const pageHeader = document.querySelector('#page-customer .page-header');
            if (!pageHeader || pageHeader.querySelector('.customer-selector')) return;

            const selector = document.createElement('div');
            selector.className = 'customer-selector';
            selector.style.cssText = 'margin-top: 16px; display: flex; gap: 12px; flex-wrap: wrap;';

            const buttons = Object.keys(customers).map(id => {
                const isActive = id === currentCustomerId;
                return `
                    <button class="btn ${isActive ? 'btn-primary' : 'btn-secondary'}" 
                            data-customer-id="${id}"
                            style="padding: 8px 16px; font-size: 13px;">
                        ${id} - ${customers[id].name.split(' ')[0]}
                    </button>
                `;
            }).join('');

            selector.innerHTML = buttons;
            pageHeader.appendChild(selector);

            // Add click handlers to buttons
            selector.querySelectorAll('button').forEach(btn => {
                btn.addEventListener('click', function () {
                    const customerId = this.getAttribute('data-customer-id');
                    loadCustomerData(customerId);

                    // Update button states
                    selector.querySelectorAll('button').forEach(b => {
                        b.classList.remove('btn-primary');
                        b.classList.add('btn-secondary');
                    });
                    this.classList.remove('btn-secondary');
                    this.classList.add('btn-primary');
                });
            });
        }

        // Action button handlers
        function executeAction(action) {
            const messages = {
                'reminder': 'Payment reminder sent successfully via SMS and Email!',
                'rm': 'Relationship Manager assigned. They will contact customer within 24 hours.',
                'restructure': 'Loan restructuring proposal prepared. Awaiting customer approval.',
                'grace': '15-day grace period activated. Penalty fees waived.'
            };

            const actionName = action.toLowerCase().includes('reminder') ? 'reminder' :
                action.toLowerCase().includes('manager') ? 'rm' :
                    action.toLowerCase().includes('restructur') ? 'restructure' : 'grace';

            if (confirm(`Execute Action: ${action}\n\nAre you sure you want to proceed?`)) {
                alert(`✅ ${messages[actionName]}\n\nStatus: In Progress\nExpected Follow-up: 2-3 business days`);
            }
        }

        // Initialize when DOM is ready
        document.addEventListener('DOMContentLoaded', function () {
            // Set initial page to dashboard
            showPage('dashboard');

            // Hide customer details section initially
            const detailsSection = document.getElementById('customerDetailsSection');
            if (detailsSection) {
                detailsSection.style.display = 'none';
            }

            // Add customer selector after a brief delay
            setTimeout(() => {
                // Don't add customer selector on initial load anymore
                // It will be shown after search

                // Make action items clickable
                const actionItems = document.querySelectorAll('.action-item');
                actionItems.forEach(item => {
                    item.addEventListener('click', function () {
                        const title = this.querySelector('.action-title').textContent;
                        executeAction(title);
                    });
                });
            }, 100);

            // Load dashboard data via API
            loadDashboardData();
        });

        // Function to load dashboard data from API
        async function loadDashboardData() {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/dashboard/overview');
                if (!response.ok) throw new Error('Failed to fetch dashboard data');
                const data = await response.json();

                // Update Portfolio Type Chart
                if (portfolioTypeChart && data.portfolio_type) {
                    portfolioTypeChart.data.datasets[0].data = data.portfolio_type.data;
                    portfolioTypeChart.update();
                }

                // Update Tenure Chart
                if (tenureChart && data.tenure) {
                    tenureChart.data.datasets[0].data = data.tenure.data;
                    tenureChart.update();
                }

                // Update Portfolio Growth Chart
                if (portfolioGrowthChart && data.portfolio_growth) {
                    portfolioGrowthChart.data.datasets[0].data = data.portfolio_growth.data;
                    portfolioGrowthChart.update();
                }

                // Update Disbursement Chart
                if (disbursementChart && data.disbursement) {
                    disbursementChart.data.datasets[0].data = data.disbursement.disbursements;
                    disbursementChart.data.datasets[1].data = data.disbursement.collections;
                    disbursementChart.update();
                }

                console.log("Dashboard data updated from API");

            } catch (error) {
                console.error('Error loading dashboard data:', error);
            }
        }

        /* Add page transition effect */
        const style = document.createElement('style');
        style.textContent = `
            .page {
                opacity: 0;
                transition: opacity 0.3s ease;
            }
            .page.active {
                opacity: 1;
            }
            .action-item {
                position: relative;
                overflow: hidden;
            }
            .action-item::before {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);
                transition: left 0.5s;
            }
            .action-item:hover::before {
                left: 100%;
            }
            .timeline-item {
                cursor: pointer;
                transition: all 0.2s;
            }
            .timeline-item:hover {
                transform: translateX(4px);
            }
            .timeline-item:hover .timeline-dot {
                transform: scale(1.1);
            }
            @keyframes pulse {
                0%, 100% {
                    opacity: 1;
                }
                50% {
                    opacity: 0.8;
                }
            }
            .kpi-card.loading {
                animation: pulse 1.5s ease-in-out infinite;
            }
            @keyframes slideIn {
                from {
                    opacity: 0;
                    transform: translateX(-20px);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
            .kpi-card {
                animation: slideIn 0.4s ease-out forwards;
            }
            .kpi-card:nth-child(1) { animation-delay: 0s; }
            .kpi-card:nth-child(2) { animation-delay: 0.1s; }
            .kpi-card:nth-child(3) { animation-delay: 0.2s; }
            .kpi-card:nth-child(4) { animation-delay: 0.3s; }
            .kpi-card:nth-child(5) { animation-delay: 0.4s; }
            .kpi-card:nth-child(6) { animation-delay: 0.5s; }
        `;
        document.head.appendChild(style);

        // Add click interaction to KPI cards
        document.addEventListener('DOMContentLoaded', function () {
            const kpiCards = document.querySelectorAll('.kpi-card');
            kpiCards.forEach(card => {
                card.addEventListener('click', function () {
                    // Add ripple effect
                    const ripple = document.createElement('div');
                    ripple.style.cssText = `
                        position: absolute;
                        border-radius: 50%;
                        background: rgba(59, 130, 246, 0.3);
                        width: 100px;
                        height: 100px;
                        margin-top: -50px;
                        margin-left: -50px;
                        animation: ripple 0.6s;
                        pointer-events: none;
                    `;

                    const rippleStyle = document.createElement('style');
                    rippleStyle.textContent = `
                        @keyframes ripple {
                            from {
                                transform: scale(0);
                                opacity: 1;
                            }
                            to {
                                transform: scale(4);
                                opacity: 0;
                            }
                        }
                    `;
                    document.head.appendChild(rippleStyle);

                    const rect = this.getBoundingClientRect();
                    const x = event.clientX - rect.left;
                    const y = event.clientY - rect.top;

                    ripple.style.left = x + 'px';
                    ripple.style.top = y + 'px';
                    this.appendChild(ripple);

                    setTimeout(() => ripple.remove(), 600);

                    // Show detail modal (simplified version)
                    const label = this.querySelector('.kpi-label').textContent.trim();
                    const value = this.querySelector('.kpi-value').textContent.trim();
                    console.log(`Clicked: ${label} - ${value}`);
                });
            });
        });
        // --- New Data Loading Functions ---

        async function loadPortfolioData() {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/portfolio/overview');
                if (!response.ok) throw new Error('Failed to fetch portfolio data');
                const data = await response.json();

                // Update KPIs
                document.getElementById('port-total-value').textContent = data.kpi.total_value.value;
                document.getElementById('port-total-trend').textContent = data.kpi.total_value.trend;
                document.getElementById('port-total-sub').textContent = data.kpi.total_value.subtitle;

                document.getElementById('port-healthy-value').textContent = data.kpi.healthy_loans.value;
                document.getElementById('port-healthy-trend').textContent = data.kpi.healthy_loans.trend;
                document.getElementById('port-healthy-sub').textContent = data.kpi.healthy_loans.subtitle;

                document.getElementById('port-avg-size-value').textContent = data.kpi.avg_loan_size.value;
                document.getElementById('port-avg-size-trend').textContent = data.kpi.avg_loan_size.trend;
                document.getElementById('port-avg-size-sub').textContent = data.kpi.avg_loan_size.subtitle;

                document.getElementById('port-npl-value').textContent = data.kpi.npl_ratio.value;
                document.getElementById('port-npl-trend').textContent = data.kpi.npl_ratio.trend;
                document.getElementById('port-npl-sub').textContent = data.kpi.npl_ratio.subtitle;

                // Update Breakdown Table
                const tbody = document.getElementById('port-breakdown-table-body');
                tbody.innerHTML = data.breakdown.map(item => `
                    <tr>
                        <td><strong>${item.type}</strong></td>
                        <td>${item.active}</td>
                        <td>${item.value}</td>
                        <td>${item.ticket}</td>
                        <td>${item.risk_count}</td>
                        <td><strong style="color: ${item.risk_class === 'badge-high' ? '#ef4444' : item.risk_class === 'badge-medium' ? '#f59e0b' : '#10b981'};">${item.risk_pct}</strong></td>
                        <td>${item.npl}</td>
                        <td><span class="badge ${item.status_class}">${item.status}</span></td>
                    </tr>
                `).join('');

                // Update Regional Container
                const regionalContainer = document.getElementById('port-regional-container');
                regionalContainer.innerHTML = data.regional.map(region => `
                    <div style="padding: 20px; background: #f8f9fb; border-radius: 12px;">
                        <div style="display: flex; justify-content: space-between; align-items: start; margin-bottom: 12px;">
                            <div>
                                <div style="font-size: 14px; font-weight: 600; color: #0f172a; margin-bottom: 4px;">${region.region}</div>
                                <div style="font-size: 13px; color: #64748b;">${region.branches}</div>
                            </div>
                            <div style="font-size: 24px; font-weight: 700; color: #1e40af;">${region.value}</div>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 12px;">
                            <span style="color: #64748b;">Active Loans:</span>
                            <strong>${region.active}</strong>
                        </div>
                        <div style="display: flex; justify-content: space-between; font-size: 13px; margin-top: 8px;">
                            <span style="color: #64748b;">Risk Level:</span>
                            <strong style="color: ${region.risk_class};">${region.risk_level}</strong>
                        </div>
                    </div>
                `).join('');

            } catch (error) {
                console.error('Error loading portfolio data:', error);
            }
        }

        async function loadOperationsData() {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/operations');
                if (!response.ok) throw new Error('Failed to fetch operations data');
                const data = await response.json();

                const tbody = document.getElementById('ops-customer-table-body');
                tbody.innerHTML = data.map(customer => `
                    <tr style="cursor: pointer;" onclick="showPage('customer'); quickLoadCustomer('${customer.id}')">
                        <td><strong>${customer.id}</strong></td>
                        <td>${customer.name}</td>
                        <td>${customer.loan}</td>
                        <td><span class="badge ${customer.score_class}">${customer.score}</span></td>
                        <td><strong style="color: ${customer.prob_color};">${customer.prob}</strong></td>
                        <td>${customer.action}</td>
                        <td><span class="badge ${customer.status_class}">${customer.status}</span></td>
                        <td>
                            <button class="btn btn-secondary" style="padding: 6px 12px; font-size: 12px;">View</button>
                        </td>
                    </tr>
                `).join('');

            } catch (error) {
                console.error('Error loading operations data:', error);
            }
        }

        async function loadModelData() {
            try {
                const response = await fetch('http://127.0.0.1:8000/api/model/metrics');
                if (!response.ok) throw new Error('Failed to fetch model data');
                const data = await response.json();

                // Update Metrics using safe navigation and checks
                if (data.metrics) {
                    const metrics = data.metrics;
                    if (metrics.accuracy) {
                        document.getElementById('model-accuracy-value').textContent = metrics.accuracy.value;
                        document.getElementById('model-accuracy-trend').textContent = metrics.accuracy.trend;
                        document.getElementById('model-accuracy-desc').textContent = metrics.accuracy.desc;
                    }
                    if (metrics.auc_roc) {
                        document.getElementById('model-auc-value').textContent = metrics.auc_roc.value;
                        document.getElementById('model-auc-trend').textContent = metrics.auc_roc.trend;
                        document.getElementById('model-auc-desc').textContent = metrics.auc_roc.desc;
                    }
                    if (metrics.fn_rate) {
                        document.getElementById('model-fnr-value').textContent = metrics.fn_rate.value;
                        document.getElementById('model-fnr-trend').textContent = metrics.fn_rate.trend;
                        document.getElementById('model-fnr-desc').textContent = metrics.fn_rate.desc;
                    }
                    if (metrics.last_trained) {
                        document.getElementById('model-last-trained-value').textContent = metrics.last_trained.value;
                        document.getElementById('model-last-trained-trend').textContent = metrics.last_trained.trend;
                        document.getElementById('model-last-trained-desc').textContent = metrics.last_trained.desc;
                    }
                }

                // Update Data Drift Alerts
                if (data.data_drift && data.data_drift.alerts) {
                    const alertsContainer = document.getElementById('model-drift-alerts');
                    alertsContainer.innerHTML = data.data_drift.alerts.map(alert => `
                        <div style="padding: 16px; background: ${alert.type === 'moderate' ? '#fef2f2' : '#fffbeb'}; border: 1px solid ${alert.type === 'moderate' ? '#fecaca' : '#fef3c7'}; border-radius: 8px; margin-bottom: 16px;">
                            <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                <span style="font-size: 24px;">${alert.type === 'moderate' ? '⚠️' : '⚡'}</span>
                                <div>
                                    <div style="font-size: 14px; font-weight: 600; color: ${alert.type === 'moderate' ? '#991b1b' : '#92400e'};">${alert.title}</div>
                                    <div style="font-size: 13px; color: ${alert.type === 'moderate' ? '#7f1d1d' : '#78350f'};">${alert.desc}</div>
                                </div>
                            </div>
                            <div style="font-size: 13px; color: ${alert.type === 'moderate' ? '#991b1b' : '#92400e'}; margin-top: 8px;">
                                PSI Score: ${alert.psi} • Threshold: ${alert.threshold}
                            </div>
                        </div>
                    `).join('');
                }

                // Update Data Drift Features
                if (data.data_drift && data.data_drift.features) {
                    const featuresContainer = document.getElementById('model-drift-features');
                    featuresContainer.innerHTML = data.data_drift.features.map(feature => `
                        <div style="margin-bottom: 20px;">
                            <div style="display: flex; justify-content: space-between; margin-bottom: 8px;">
                                <span style="font-size: 14px; font-weight: 600;">${feature.name}</span>
                                <span style="font-size: 14px; font-weight: 700; color: ${feature.color};">${feature.status}</span>
                            </div>
                            <div class="progress-bar">
                                <div class="progress-fill" style="width: ${feature.value}%; background: linear-gradient(90deg, ${feature.color} 0%, ${feature.color}dd 100%);"></div>
                            </div>
                        </div>
                    `).join('');
                }

            } catch (error) {
                console.error('Error loading model data:', error);
            }
        }
    </script>
</body>

</html>